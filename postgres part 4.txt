+++completed projects not in donations table+++
select A._projectid, A.date_posted, A.date_completed, A.total_price_excluding_optional_support,
A.total_donations, A.funding_status
from projects A left join 
donations B on A._projectid = B._projectid where B._projectid is null  
and A.funding_status= 'completed' order by total_price_excluding_optional_support desc limit 10;

select count(A._projectid) from projects A left join 
donations B on A._projectid = B._projectid where B._projectid is null  
and A.funding_status= 'completed';



create table agg_donations as
select 
 _projectid,
count(_donationid) as doncount,
count(_donor_acctid) as donorcount,
sum(donation_to_project) as dontoproj,
sum(donation_optional_support) as optsupport,
sum(donation_total) as dontotal
from donations group by _projectid;


create table agg_donations2 as select 
A.*, 
B.date_posted,
B.total_price_including_optional_support,
B.total_price_excluding_optional_support
from agg_donations A join 
projects B on
A._projectid = B._projectid
where B.funding_status = 'completed';

select avg(dontotal/doncount) from donproj2 where date_posted > '2003-01-01';

select avg(total_donations/num_donors) from projects 
where date_posted > '2003-01-01' and funding_status = 'completed' and num_donors>0;


create table proj_in_givingproj_not_in_proj as 
select giveproj._projectid from givingproj giveproj left join projects proj 
on giveproj._projectid = proj._projectid 
where proj._projectid is null;

